<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:c="http://java.sun.com/jsp/jstl/core">

    <p:dataTable id="idTabelaIrrf" var="irrf" value="#{irrfView.listTabela}" selection="#{irrfView.tabela}" selectionMode="single"
                 rowKey="#{irrf.codigoTabela}" paginator="true" rows="20" paginatorPosition="bottom">
        <f:facet name="header">
            <p:outputLabel value="#{msgs['ln.texto.tabelairrf']}"/>
        </f:facet>
        <p:column style="width: 16px">
            <p:rowToggler />
        </p:column>
        <p:column headerText="#{msgs['ln.texto.descricao']}">
            <h:outputText value="#{irrf.nomeTabela}"/>
        </p:column>
        <p:column headerText="#{msgs['ln.texto.datainicio']}">
            <h:outputText value="#{irrf.dataInicial}">
                <f:convertDateTime pattern="dd-MM-yyyy"/>
            </h:outputText>
        </p:column>
        <p:column headerText="#{msgs['ln.texto.datafinal']}">
            <h:outputText value="#{irrf.dataFinal}">
                <f:convertDateTime pattern="dd-MM-yyyy"/>
            </h:outputText>
        </p:column>
        <p:rowExpansion>
            <p:dataTable id="idTabelaIrrfDetalhe" var="irrfDetalhe" value="#{irrf.listTabelaItem}"
                         paginator="true" rows="20" paginatorPosition="bottom">
                <p:column headerText="#{msgs['ln.texto.valorinicial']}">
                    <h:outputText value="#{irrfDetalhe.valorInicial}">
                        <f:convertNumber pattern="#{msgs['ln.texto.cifrao']} ###,##0.00" type="currency"/>
                    </h:outputText>
                </p:column>
                <p:column headerText="#{msgs['ln.texto.valorfinal']}">
                    <h:outputText value="#{irrfDetalhe.valorFinal}">
                        <f:convertNumber pattern="#{msgs['ln.texto.cifrao']} ###,##0.00" type="currency"/>
                    </h:outputText>
                </p:column>
                <p:column headerText="#{msgs['ln.texto.percentual']}">
                    <h:outputText value="#{irrfDetalhe.percentual}">
                        <f:convertNumber pattern="##0.00" type="percent" />
                    </h:outputText>
                </p:column>
                <p:column headerText="#{msgs['ln.texto.valordesconto']}">
                    <h:outputText value="#{irrfDetalhe.valorDesconto}">
                        <f:convertNumber pattern="#{msgs['ln.texto.cifrao']} ###,##0.00" type="currency"/>
                    </h:outputText>
                </p:column>
                <p:column headerText="#{msgs['ln.texto.valordependente']}">
                    <h:outputText value="#{irrfDetalhe.valorDependente}">
                        <f:convertNumber pattern="#{msgs['ln.texto.cifrao']} ###,##0.00" type="currency"/>
                    </h:outputText>
                </p:column>
            </p:dataTable>
        </p:rowExpansion>
        <f:facet name="footer">
            <p:commandButton id="btIncluirIrrf" value="#{msgs['ln.bt.incluir']}" icon="ui-icon-document" 
                             action="#{irrfView.btIncluir}" process="btIncluirIrrf" 
                             update=":idFormCenter:idtabelas:idTabelaIrrf, :idFormTop:growl, :idFormCenter:idtabelas:dlgIRRF"/>
            <p:commandButton id="btAlterarIrrf" value="#{msgs['ln.bt.alterar']}" icon="ui-icon-pencil"
                             action="#{irrfView.btAlterar}" process="btAlterarIrrf, :idFormCenter:idtabelas:idTabelaIrrf"
                             update=":idFormTop:growl, :idFormCenter:idtabelas:dlgIRRF" />
            <p:commandButton id="btExcluirIrrf" value="#{msgs['ln.bt.excluir']}" icon="ui-icon-trash"
                             action="#{irrfView.btExcluir}" process="btExcluirIrrf,:idFormCenter:idtabelas:idTabelaIrrf"
                             update=":idFormTop:growl,:idFormCenter:idtabelas:idTabelaIrrf">
                <p:confirm header="#{msgs['ln.texto.confirmacao']}" message="#{msgs['ln.frase.confirmaexclusao']}" icon="ui-icon-alert"/>
            </p:commandButton>
            <p:confirmDialog global="true" showEffect="fade" hideEffect="explode">
                <p:commandButton value="#{msgs['ln.bt.sim']}" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
                <p:commandButton value="#{msgs['ln.bt.nao']}" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
            </p:confirmDialog>
            <p:commandButton id="idirrfbtHistorico" value="#{msgs['ln.bt.historico']}" icon="ui-icon-notice" 
                             onclick="PF('historico').show()"/>
            <p:commandButton id="idirrfclose" value="#{msgs['ln.bt.fechar']}" icon="ui-icon-circlesmall-close" 
                             action="#{irrfView.btVoltar}" process="idirrfclose" update="idirrfclose, :idFormCenter"/>
        </f:facet>
    </p:dataTable>

    <p:dialog id="dlgIRRF" header="#{msgs['ln.frase.inclusaotabela']}" widgetVar="IrrfEdit" modal="false" showEffect="fade" hideEffect="fade" 
              closable="false" style="background-color: activeborder" width="1000" dynamic="true">

        <h:panelGrid id="idgridDataIrrf" columns="6" >
            <p:outputLabel value="#{msgs['ln.texto.descricao']}"/>
            <p:inputText id="idIrrfDescricao" value="#{irrfView.nomeTabela}" size="50"/>
            <p:outputLabel for="dtirrfInicio" value="#{msgs['ln.texto.datainicio']}"/>
            <p:calendar id="dtirrfInicio" showOn="button" value="#{irrfView.dataInicial}" pattern="dd/MM/yyyy"/>
            <p:outputLabel for="dtirrfFinal" value="#{msgs['ln.texto.datafinal']}"/>
            <p:calendar id="dtirrfFinal" showOn="button" value="#{irrfView.dataFinal}" pattern="dd/MM/yyyy"/>
        </h:panelGrid>
        <h:panelGrid id="idgridValorIrrf" columns="6" style="margin-left: 35px;">
            <p:outputLabel value="#{msgs['ln.texto.valorinicial']}"/>
            <p:inputText id="idinputvlrinicial" value="#{irrfView.valorInicial}" style="width: 80px;" size="20">
                <f:convertNumber pattern="#,##0.00" currencySymbol="#{msgs['ln.texto.cifrao']}" type="currency"/>
                <p:ajax update="idinputvlrinicial" process="idinputvlrinicial" event="change"/>
            </p:inputText>
            <p:outputLabel value="#{msgs['ln.texto.datafinal']}"/>
            <p:inputText id="idvlrFinal" value="#{irrfView.valorFinal}" style="width: 80px;" size="20">
                <f:convertNumber pattern="#,##0.00" currencySymbol="#{msgs['ln.texto.cifrao']}" type="currency"/>
                <p:ajax update="idvlrFinal" process="idvlrFinal" event="change"/>
            </p:inputText>

            <p:outputLabel value="#{msgs['ln.texto.percentualimposto']}"/>
            <p:inputText id="idpercImposto" value="#{irrfView.percentual}" style="width: 80px;" size="20">
                <f:convertNumber pattern="##0.00" type="percent"/>
                <p:ajax update="idpercImposto" process="idpercImposto" event="change"/>
            </p:inputText>
            <p:outputLabel value="#{msgs['ln.texto.valordesconto']}"/>
            <p:inputText id="idvlrDesconto" value="#{irrfView.valorDesconto}" style="width: 80px;" size="20">
                <f:convertNumber pattern="#,##0.00" currencySymbol="#{msgs['ln.texto.cifrao']}" type="currency"/>
                <p:ajax update="idvlrDesconto" process="idvlrDesconto" event="change"/>
            </p:inputText>
            <p:outputLabel value="#{msgs['ln.frase.valorpordependente']}"/>
            <p:inputText id="idvlrDependente"  value="#{irrfView.valorDependente}" style="width: 80px;" size="20">
                <f:convertNumber pattern="#,##0.00" currencySymbol="#{msgs['ln.texto.cifrao']}" type="currency"/>
                <p:ajax update="idvlrDependente" process="idvlrDependente" event="change"/>
            </p:inputText>
        </h:panelGrid>
        <p:dataTable id="idDTIRRF" var="incluiTabelaIR" value="#{irrfView.listTabelaItem}" paginator="true" rows="10" paginatorPosition="bottom">
            <f:facet name="header">
                <p:outputLabel value="#{msgs['ln.frase.irrf']}"/>
            </f:facet>
            <p:column headerText="#{msgs['ln.texto.valorinicial']}" style="width: 40px">
                <h:outputText value="#{incluiTabelaIR.valorInicial}">
                    <f:convertNumber pattern="#{msgs['ln.texto.cifrao']} ###,##0.00" type="currency" currencySymbol="#{msgs['ln.texto.cifrao']}"/>
                </h:outputText>
            </p:column>
            <p:column headerText="#{msgs['ln.texto.valorfinal']}" style="width: 40px">
                <h:outputText value="#{incluiTabelaIR.valorFinal}">
                    <f:convertNumber pattern="#{msgs['ln.texto.cifrao']} ###,##0.00" type="currency" currencySymbol="#{msgs['ln.texto.cifrao']}"/>
                </h:outputText>
            </p:column>
            <p:column headerText="#{msgs['ln.texto.qtddependente']}" style="width: 40px">
                <h:outputText value="#{incluiTabelaIR.qtdDependente}">
                    <f:convertNumber pattern="##0" type="number"/>
                </h:outputText>
            </p:column>
            <p:column headerText="#{msgs['ln.texto.percentualimposto']}" style="width: 40px">
                <h:outputText value="#{incluiTabelaIR.percentual}">
                    <f:convertNumber pattern="##0.00" type="percent"/>
                </h:outputText>
            </p:column>
            <p:column headerText="#{msgs['ln.texto.valordesconto']}" style="width: 40px">
                <h:outputText value="#{incluiTabelaIR.valorDesconto}">
                    <f:convertNumber pattern="#{msgs['ln.texto.cifrao']} ###,##0.00" type="currency" currencySymbol="#{msgs['ln.texto.cifrao']}"/>
                </h:outputText>
            </p:column>
            <p:column headerText="#{msgs['ln.frase.valorpordependente']}" style="width: 40px">
                <h:outputText value="#{incluiTabelaIR.valorDependente}">
                    <f:convertNumber pattern="#{msgs['ln.texto.cifrao']} ###,##0.00" type="currency" currencySymbol="#{msgs['ln.texto.cifrao']}"/>
                </h:outputText>
            </p:column>
            <p:column style="width: 20px; text-align: center">
                <p:commandButton id='idBtEditaIRRF' icon="ui-icon-trash" action="#{irrfView.btExcluiDetalhe}"
                                 process="idBtEditaIRRF, idDTIRRF" update="idDTIRRF, :idFormTop:growl">
                    <f:setPropertyActionListener value="#{incluiTabelaIR}" target="#{irrfView.tabelaItem}"/>
                </p:commandButton>
            </p:column>
        </p:dataTable>
        <f:facet name="footer">
            <p:commandButton id="idbtincluirirrf" value="#{msgs['ln.bt.incluir']}" icon="ui-icon-document"
                             action="#{irrfView.btIncluiDetalhe()}" process="idbtincluirirrf, idgridDataIrrf, idgridValorIrrf, idIrrfDescricao,
                             dtirrfInicio, dtirrfFinal, idinputvlrinicial, idvlrFinal, idpercImposto, idvlrDesconto, idvlrDependente"
                             update="idDTIRRF, :idFormTop:growl"/>
            <p:commandButton id="idbtsalvarirrf" value="#{msgs['ln.bt.salvar']}" icon="ui-icon-disk"
                             action="#{irrfView.btSalvar}" process="idbtsalvarirrf, idgridDataIrrf, idIrrfDescricao, dtirrfInicio, dtirrfFinal, idDTIRRF" 
                             update=":idFormTop:growl, :idFormCenter:idtabelas:idTabelaIrrf, idgridDataIrrf"/>
            <p:commandButton id="idbtfecharirrf" value="#{msgs['ln.bt.fechar']}" icon="ui-icon-cancel"
                             action="#{irrfView.btFechar()}" process="idbtfecharirrf" update="idbtfecharirrf"/>
        </f:facet>

    </p:dialog>
</ui:composition>
